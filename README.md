# Heart diseases prediction

В проекте предстоит работать с базой данных, которая хранит информацию о пациентах. Метрика, используемая в проекте ROC AUC score.

**Признаки**
- id — индекс пациента
- age — возраст пациента
- gender — пол пациента
- height — рост пациента, см
- weight — вес пациента, кг
- ap_hi — систолическое давление(верхнее)
- ap_lo — диастолическое давление(нижнее)
- cholesterol — уровень холестерина
- gluc — уровень глюкозы
- smoke — курящий пациент
- alco — отношение к алкоголю у пациента
- active — физическая активность пациента

**Целевой признак**
- Cardio — risk of heart diseases


## Цель исследования:

Необходимо предсказать риск сердечного заболевания исходя из образа жизни пациента.

## Ход исследования:

Шаг 1. Преобработка данных
Так как набор датасета не большой, терять респондентов было не желательно, поэтому было потрачено значительно усилий, что вернуть или опознать выдающиеся значения.
* 'вес' отработаны отрицательные значения, все что ниже 20 и выше 200 заменено на медиану
* 'рост' отработаны отрицательные значения, все что ниже 70 и выше 215 заменено на медиану
* 'нижнее/верхнее давление' отработаны отрицательные значения, экстремально высокие значения были признаны ошибкой при вводе, проведена деноминация таких значений, все что не попало под эту категорию заменено на медианные значения. Если нижнее значение оказывалось выше верхнего, то меняли их местами.
* вместо двух признаков Рост/Вес, создана одна Индекс массы тела, которая будет вычисляться по формуле вес/(рост в метрах)^2 

Шаг 2. Подбор параметров модели
Так как нельзя наверняка сказать, что признаки соответствуют нормальному распределению, поэтому принято решение использовать масштабирование MinMaxScaler()
Подбор параметров осуществялся с помощью библиотеки Optuna, в качестве моделей выступали: RandomForestClassifier, которая впоследствии была заменена на GradientBoostingClassifier.
После множества попыток подбора гиперпараметров модели, остановился на следующих для GradientBoostingClassifier {'n_estimators': 135, 'max_depth': 5, 'min_samples_leaf': 12, 'min_samples_split': 10, 'learning_rate': 0.07, 'max_features': 4, 'subsample': 0.8}. Результат Roc_auc на 100% данных в Кагл показывает 0.80370, что соотвествует пятому месту в итоговом зачете из 55 участников.

Шаг 3. Определение важности признаков, оформление web-приложения, которое рассчитывает вероятность риска развития сердечно-сосудистого заболевания и выдает рекомендации пользователям.


## Итог исследования:

RocAUC Score - 0.80370

## Стек технологий:

`pandas`, `matplotlib`, `numpy`, `scikit-learn`, `imbalanced-learn`

## Статус проекта:

Завершен.
